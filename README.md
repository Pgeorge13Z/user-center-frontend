# ç”¨æˆ·ä¸­å¿ƒç³»ç»Ÿ by Pgeorge

## ğŸ¯ å¹³å°ç®€ä»‹

é‡‡ç”¨Springboot+Reactæ¡†æ¶æ­å»ºçš„ç”¨æˆ·ä¸­å¿ƒç®¡ç†ç³»ç»Ÿï¼Œä½œä¸ºåŸºç¡€å¹³å°ï¼Œå®Œæˆäº†ç”¨æˆ·çš„åŸºæœ¬ç®¡ç†åŠŸèƒ½ï¼Œå¦‚æ³¨å†Œã€ç™»å½•ã€è®¤è¯ã€ä¿®æ”¹ç­‰å¤šä¸ªåŠŸèƒ½ã€‚åç»­æœ¬äººä¼šæ¥å…¥æœ¬äººå®Œæˆçš„å„ç§ç³»ç»Ÿï¼Œå¹¶è¿›ä¸€æ­¥æ”¹è¿›æœ¬ç®¡ç†ç³»ç»Ÿã€‚



## ğŸ¶ åœ¨çº¿åœ°å€

* åœ¨çº¿åœ°å€:http://user.code-club.fun/user/login
* åç«¯æºç ã€springboot+Mysql+Mybatis-plusã€‘:https://github.com/Pgeorge13Z/User-center-backend
* å‰ç«¯æºç ã€React+Ant Design PROã€‘:https://github.com/Pgeorge13Z/user-center-frontend

## ğŸ¼æŠ€æœ¯é€‰å‹

å‰ç«¯ï¼š

- React å¼€å‘æ¡†æ¶
- Ant Design Proï¼ˆç°æˆçš„ç®¡ç†ç³»ç»Ÿï¼‰


åç«¯ï¼š

- mybatis-plusï¼ˆå¯¹ mybatis çš„å¢å¼ºï¼Œä¸ç”¨å†™ sql ä¹Ÿèƒ½å®ç°å¢åˆ æ”¹æŸ¥ï¼‰
- springbootï¼ˆ**å¿«é€Ÿå¯åŠ¨** / å¿«é€Ÿé›†æˆé¡¹ç›®ã€‚ä¸ç”¨è‡ªå·±ç®¡ç† spring é…ç½®ï¼Œä¸ç”¨è‡ªå·±æ•´åˆå„ç§æ¡†æ¶ï¼‰
- junit å•å…ƒæµ‹è¯•åº“

## ğŸ¨ å†…ç½®åŠŸèƒ½

| åŠŸèƒ½       | æè¿°                                                         |
| ---------- | ------------------------------------------------------------ |
| ç™»å½•/æ³¨å†Œ  | å¯†ç åŠ å¯†å­˜å‚¨ï¼Œtodoï¼šåç»­å¢åŠ åˆ†å¸ƒå¼sessionçš„æ–¹æ³•æ”¹è¿›          |
| ç”¨æˆ·ç®¡ç†   | åŒ…æ‹¬å¢æ·»ã€åˆ é™¤ã€ä¿®æ”¹ç”¨æˆ·ï¼ŒåŒ…å«**æƒé™æ£€éªŒ**é€»è¾‘ï¼Œå’ŒOssåœ¨çº¿ç®¡ç†å¤´åƒç­‰å›¾ç‰‡ä¿¡æ¯ã€‚ |
| å®¹å™¨åŒ–éƒ¨ç½² | æä¾›äº†Docker**å®¹å™¨åŒ–éƒ¨ç½²**çš„æ–¹æ¡ˆï¼Œå¹¶è§£å†³äº†**è·¨åŸŸ**ç­‰é—®é¢˜     |

## ğŸ·æ¼”ç¤ºå›¾

| æ¨¡å—               | æ¼”ç¤º                                                         | æ¼”ç¤º                                                         |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ç™»å½• & æ³¨å†Œ        | ![image-20231103175854550](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031758623.png) | ![image-20231103175907969](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031759004.png) |
| é¦–é¡µ               | ![image-20231103175956592](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031759240.png) |                                                              |
| ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰ | ![image-20231103180024015](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031800129.png) | ![image-20231103180047378](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031800463.png) |
| ä¸ªäººä¿¡æ¯ç®¡ç†       | ![image-20231103180133200](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031801369.png) |                                                              |



## æ‚è®°

åœ¨åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œå­¦ä¼šçš„ä¸€äº›å°tipsã€‚

### 1. IDEAæ’ä»¶ï¼š

1. GenerateAllSetter : alt+insert å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰setæ–¹æ³•ã€‚
2. GenerateSerialVersionUID åœ¨implements Serializableæ¥å£æ—¶alt+insert å¯ä»¥è‡ªåŠ¨ç”Ÿæˆåºåˆ—åŒ–IDã€‚
3. Auto Filling Java Call Arguments åœ¨è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œalt+insert å¯ä»¥è‡ªåŠ¨å¡«å……æ–¹æ³•å‚æ•°ã€‚



### 2.è°ƒè¯•æ–¹æ³•ï¼š

* F7ï¼š Step into è¿›å…¥æ–¹æ³•
* F8ï¼š Step Over ä»¥è¡Œä¸ºå•ä½ï¼Œä¸è¿›å…¥æ–¹æ³•
* F9ï¼š è·³åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œæ²¡æœ‰çš„è¯å°±ç»“æŸ



å› æ­¤ æ¯”å¦‚å¯ä»¥åœ¨controllerçš„æ¯ä¸€è¡Œæ‰“ä¸Šæ–­ç‚¹ï¼Œç„¶åç»™è°ƒç”¨çš„é‡è¦ä¸šåŠ¡ï¼Œå¦‚Serviceé‡Œçš„æ–¹æ³•æ‰“ä¸Šæ–­ç‚¹ï¼Œé€šè¿‡F9 è¿›å…¥Serviceä¸­ã€‚

ï¼ˆéœ€è¦å…ˆæ‰“å¼€Applicationä¸»æ–‡ä»¶çš„debugï¼Œæ‰“å¼€æœåŠ¡å™¨ï¼‰



### 3.é€»è¾‘åˆ é™¤ï¼š

mybatis-plusçš„åŠŸèƒ½ï¼ˆå­¦ä¼šæŸ¥å®˜æ–¹æ–‡æ¡£ï¼Œæ‰¾é…ç½®é€»è¾‘åˆ é™¤ï¼‰ï¼Œ

1. åœ¨domainçš„userä¸­ç»™éœ€è¦é€»è¾‘åˆ é™¤çš„å˜é‡åŠ ä¸Š@TableLogic

2. åœ¨`application.yml`ä¸­é…ç½®å¦‚ä¸‹å†…å®¹ï¼š

```yam
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: false

  global-config:
    db-config:
      logic-delete-field: isDelete # å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå(since 3.3.0,é…ç½®åå¯ä»¥å¿½ç•¥ä¸é…ç½®æ­¥éª¤2)
      logic-delete-value: 1 # é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)
      logic-not-delete-value: 0 # é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)
```



ç¬¬ä¸€ä¸ªé…ç½®æ˜¯å–æ¶ˆmybatis-plusçš„è‡ªåŠ¨åŠ ç²—åŠŸèƒ½ï¼›

ç¬¬äºŒä¸ªé…ç½®æ˜¯è®¾ç½®é€»è¾‘åˆ é™¤ï¼Œå³æ•°æ®åº“ä¸­è®¾ç½®isDeleteä¸º1æ—¶ï¼Œä¾¿æŸ¥è¯¢ä¸åˆ°æ­¤å€¼ã€‚



### 4. å¿«æ·é”®ï¼š

 shift+F6 é‡æ„ï¼ˆæ‰¹é‡æ›´æ”¹ä¸€ä¸ªå˜é‡ï¼‰

ctrl shift  -  å…¨éƒ¨æŠ˜å 



### 5. è·¨åŸŸé—®é¢˜è§£å†³

æµè§ˆå™¨ä¸ºäº†ç”¨æˆ·çš„å®‰å…¨ï¼Œä»…å…è®¸å‘ **åŒåŸŸåã€åŒç«¯å£** çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚

å¦‚ä½•è§£å†³è·¨åŸŸï¼Ÿ

æœ€ç›´æ¥çš„æ–¹å¼ï¼šæŠŠåŸŸåã€ç«¯å£æ”¹æˆç›¸åŒçš„

### æ·»åŠ è·¨åŸŸå¤´

è®©æœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ï¼šå…è®¸è·¨åŸŸï¼ˆè¿”å› cross-origin-allow å“åº”å¤´ï¼‰

#### 1. ç½‘å…³æ”¯æŒï¼ˆNginxï¼‰

```nginx
# è·¨åŸŸé…ç½®
location ^~ /api/ {
    proxy_pass http://127.0.0.1:8081/api/;
    add_header 'Access-Control-Allow-Origin' $http_origin;
    add_header 'Access-Control-Allow-Credentials' 'true';
    add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
    add_header Access-Control-Allow-Headers '*';
    if ($request_method = 'OPTIONS') {
        add_header 'Access-Control-Allow-Credentials' 'true';
        add_header 'Access-Control-Allow-Origin' $http_origin;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
        add_header 'Access-Control-Max-Age' 1728000;
        add_header 'Content-Type' 'text/plain; charset=utf-8';
        add_header 'Content-Length' 0;
        return 204;
    }
}
```

#### 2. ä¿®æ”¹åç«¯æœåŠ¡

1. é…ç½® @CrossOrigin æ³¨è§£

2. æ·»åŠ  web å…¨å±€è¯·æ±‚æ‹¦æˆªå™¨

   ```java
   @Configuration
   public class WebMvcConfg implements WebMvcConfigurer {
    
       @Override
       public void addCorsMappings(CorsRegistry registry) {
           //è®¾ç½®å…è®¸è·¨åŸŸçš„è·¯å¾„
           registry.addMapping("/**")
                   //è®¾ç½®å…è®¸è·¨åŸŸè¯·æ±‚çš„åŸŸå
                   //å½“**Credentialsä¸ºtrueæ—¶ï¼Œ**Originä¸èƒ½ä¸ºæ˜Ÿå·ï¼Œéœ€ä¸ºå…·ä½“çš„ipåœ°å€ã€å¦‚æœæ¥å£ä¸å¸¦cookie,ipæ— éœ€è®¾æˆå…·ä½“ipã€‘
                   .allowedOrigins("http://localhost:9527", "http://127.0.0.1:9527", "http://127.0.0.1:8082", "http://127.0.0.1:8083")
                   //æ˜¯å¦å…è®¸è¯ä¹¦ ä¸å†é»˜è®¤å¼€å¯
                   .allowCredentials(true)
                   //è®¾ç½®å…è®¸çš„æ–¹æ³•
                   .allowedMethods("*")
                   //è·¨åŸŸå…è®¸æ—¶é—´
                   .maxAge(3600);
       }
   }
   ```

3. å®šä¹‰æ–°çš„ corsFilter Beanï¼Œå‚è€ƒï¼šhttps://www.jianshu.com/p/b02099a435bd



### 6.Dockerå¸¸ç”¨å‘½ä»¤

æ ¹æ® Dockerfile æ„å»ºé•œåƒï¼š

```bash
# åç«¯
docker build -t user-center-backend:v0.0.1 .

# å‰ç«¯
docker build -t user-center-frontend:v0.0.1 .
```

Docker æ„å»ºä¼˜åŒ–ï¼šå‡å°‘å°ºå¯¸ã€å‡å°‘æ„å»ºæ—¶é—´ï¼ˆæ¯”å¦‚å¤šé˜¶æ®µæ„å»ºï¼Œå¯ä»¥ä¸¢å¼ƒä¹‹å‰é˜¶æ®µä¸éœ€è¦çš„å†…å®¹ï¼‰

docker run å¯åŠ¨ï¼š

```bash
# å‰ç«¯
docker run -p 80:80 --ulimit nofile=65535:65535 -d user-center-frontend:v0.0.1

# åç«¯
docker run -p 8081:8081 --ulimit nofile=65535:65535 -d user-center-backend:v0.0.1
```

è™šæ‹ŸåŒ–

1. ç«¯å£æ˜ å°„ï¼šæŠŠæœ¬æœºçš„èµ„æºï¼ˆå®é™…è®¿é—®åœ°å€ï¼‰å’Œå®¹å™¨å†…éƒ¨çš„èµ„æºï¼ˆåº”ç”¨å¯åŠ¨ç«¯å£ï¼‰è¿›è¡Œå…³è”
2. ç›®å½•æ˜ å°„ï¼šæŠŠæœ¬æœºçš„ç«¯å£å’Œå®¹å™¨åº”ç”¨çš„ç«¯å£è¿›è¡Œå…³è”



è¿›å…¥å®¹å™¨ï¼š

```bash
docker exec -i -t  fee2bbb7c9ee /bin/bash
```



æŸ¥çœ‹è¿›ç¨‹ï¼š

```bash
docker ps 
```



æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
docker logs -f [container-id]
```



æ€æ­»å®¹å™¨ï¼š

```bash
docker kill
```



åˆ é™¤å®¹å™¨ï¼š

```bash
docker rm
```





å¼ºåˆ¶åˆ é™¤é•œåƒï¼š

```bash
docker rmi -f
```

